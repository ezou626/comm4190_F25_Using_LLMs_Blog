<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eric Zou">
<meta name="dcterms.date" content="2025-12-14">
<meta name="description" content="Introducing objects and activities that agents can discover and interact with">

<title>Adding Activities: Objects and Interactions in the 2D World – My Explorations with LLMs in Social Contexts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-0b37c64f34216b628666a8dac638b53b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations with LLMs in Social Contexts</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ezou626"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/EDubsZ123"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Adding Activities: Objects and Interactions in the 2D World</h1>
                  <div>
        <div class="description">
          Introducing objects and activities that agents can discover and interact with
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Agents</div>
                <div class="quarto-category">Simulation</div>
                <div class="quarto-category">World Building</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Eric Zou </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 14, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="a-world-with-things-to-do" class="level1">
<h1>A World with Things to Do</h1>
<p>So far, our 2D world has been empty—just agents moving and talking. But a real virtual world needs <strong>objects</strong> and <strong>activities</strong>. Agents should be able to discover items, interact with them, and discuss what they find.</p>
<p>This post adds: - <strong>Objects</strong>: Items that exist in the world at specific locations - <strong>Activities</strong>: Actions agents can perform on objects - <strong>Discovery</strong>: Agents can find objects as they explore - <strong>Interaction</strong>: Agents can use objects, which creates new conversation topics</p>
<section id="object-types" class="level2">
<h2 class="anchored" data-anchor-id="object-types">Object Types</h2>
<p>We’ll implement several object types: - <strong>Tools</strong>: Items that can be used (e.g., “hammer”, “key”) - <strong>Landmarks</strong>: Interesting locations (e.g., “fountain”, “tree”) - <strong>Items</strong>: Collectible objects (e.g., “coin”, “book”)</p>
</section>
<section id="setup-and-imports" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-imports">Setup and Imports</h2>
<div id="1eae8f79" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass, field</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Optional, Dict</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> enum <span class="im">import</span> Enum</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openai <span class="im">import</span> OpenAI</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>load_dotenv(<span class="st">"../../.env"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> OpenAI()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>GRID_SIZE <span class="op">=</span> <span class="dv">20</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="object-and-activity-definitions" class="level2">
<h2 class="anchored" data-anchor-id="object-and-activity-definitions">Object and Activity Definitions</h2>
<div id="6566fcef" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ObjectType(Enum):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    TOOL <span class="op">=</span> <span class="st">"tool"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    LANDMARK <span class="op">=</span> <span class="st">"landmark"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    ITEM <span class="op">=</span> <span class="st">"item"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WorldObject:</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""An object that exists in the world."""</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    x: <span class="bu">int</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    y: <span class="bu">int</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    obj_type: ObjectType</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    description: <span class="bu">str</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    interactable: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_position(<span class="va">self</span>):</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.x, <span class="va">self</span>.y)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> distance_to(<span class="va">self</span>, x: <span class="bu">int</span>, y: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Calculate distance to a point."""</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ((<span class="va">self</span>.x <span class="op">-</span> x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (<span class="va">self</span>.y <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="fl">0.5</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Activity:</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""An activity that can be performed on an object."""</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">@staticmethod</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_activity_description(obj: WorldObject, agent_name: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate a description of interacting with an object."""</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> obj.obj_type <span class="op">==</span> ObjectType.TOOL:</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>agent_name<span class="sc">}</span><span class="ss"> uses the </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss">."</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> obj.obj_type <span class="op">==</span> ObjectType.LANDMARK:</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>agent_name<span class="sc">}</span><span class="ss"> examines the </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss">."</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> obj.obj_type <span class="op">==</span> ObjectType.ITEM:</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>agent_name<span class="sc">}</span><span class="ss"> picks up the </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss">."</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>agent_name<span class="sc">}</span><span class="ss"> interacts with the </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss">."</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="enhanced-agent-class" class="level2">
<h2 class="anchored" data-anchor-id="enhanced-agent-class">Enhanced Agent Class</h2>
<p>Agents need to be aware of objects in the world.</p>
<div id="c3df5a43" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Agent:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    name: <span class="bu">str</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    x: <span class="bu">int</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    y: <span class="bu">int</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    color: <span class="bu">str</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    history: <span class="bu">list</span> <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    discovered_objects: <span class="bu">list</span> <span class="op">=</span> field(default_factory<span class="op">=</span><span class="bu">list</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> move(<span class="va">self</span>, dx, dy):</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, <span class="bu">min</span>(GRID_SIZE<span class="op">-</span><span class="dv">1</span>, <span class="va">self</span>.x <span class="op">+</span> dx))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, <span class="bu">min</span>(GRID_SIZE<span class="op">-</span><span class="dv">1</span>, <span class="va">self</span>.y <span class="op">+</span> dy))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_position(<span class="va">self</span>):</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.x, <span class="va">self</span>.y)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> find_nearby_objects(<span class="va">self</span>, objects: List[WorldObject], radius: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span>) <span class="op">-&gt;</span> List[WorldObject]:</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Find objects within radius."""</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        nearby <span class="op">=</span> []</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> obj <span class="kw">in</span> objects:</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> obj.distance_to(<span class="va">self</span>.x, <span class="va">self</span>.y) <span class="op">&lt;=</span> radius:</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                nearby.append(obj)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> obj <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.discovered_objects:</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.discovered_objects.append(obj)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> nearby</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="world-with-objects" class="level2">
<h2 class="anchored" data-anchor-id="world-with-objects">World with Objects</h2>
<p>Let’s create a world populated with objects and run a simulation.</p>
<div id="ef9a84fc" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_world_objects(num_objects: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> List[WorldObject]:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Create a set of objects scattered across the world."""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    objects <span class="op">=</span> []</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    object_templates <span class="op">=</span> [</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        (ObjectType.TOOL, <span class="st">"hammer"</span>, <span class="st">"A sturdy hammer that could be useful"</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        (ObjectType.TOOL, <span class="st">"key"</span>, <span class="st">"A mysterious key"</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        (ObjectType.LANDMARK, <span class="st">"fountain"</span>, <span class="st">"A beautiful fountain in the center"</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        (ObjectType.LANDMARK, <span class="st">"ancient_tree"</span>, <span class="st">"An ancient tree with gnarled branches"</span>),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        (ObjectType.ITEM, <span class="st">"coin"</span>, <span class="st">"A shiny gold coin"</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        (ObjectType.ITEM, <span class="st">"book"</span>, <span class="st">"An old book with worn pages"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        (ObjectType.TOOL, <span class="st">"compass"</span>, <span class="st">"A compass that points north"</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        (ObjectType.LANDMARK, <span class="st">"statue"</span>, <span class="st">"A statue of an unknown figure"</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    used_positions <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_objects):</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        obj_type, name, description <span class="op">=</span> random.choice(object_templates)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Find an unused position</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        x, y <span class="op">=</span> random.randint(<span class="dv">0</span>, GRID_SIZE<span class="op">-</span><span class="dv">1</span>), random.randint(<span class="dv">0</span>, GRID_SIZE<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        attempts <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> (x, y) <span class="kw">in</span> used_positions <span class="kw">and</span> attempts <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            x, y <span class="op">=</span> random.randint(<span class="dv">0</span>, GRID_SIZE<span class="op">-</span><span class="dv">1</span>), random.randint(<span class="dv">0</span>, GRID_SIZE<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>            attempts <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        used_positions.add((x, y))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        objects.append(WorldObject(name, x, y, obj_type, description))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> objects</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_world_with_objects(agents: List[Agent], objects: List[WorldObject], num_rounds: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span>):</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Run a simulation with agents and objects."""</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    transcript <span class="op">=</span> []</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> round_num <span class="kw">in</span> <span class="bu">range</span>(num_rounds):</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\\</span><span class="ss">n=== Round </span><span class="sc">{</span>round_num <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> ==="</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shuffle agent order</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        shuffled_agents <span class="op">=</span> agents.copy()</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        random.shuffle(shuffled_agents)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> agent <span class="kw">in</span> shuffled_agents:</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find nearby objects</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>            nearby_objects <span class="op">=</span> agent.find_nearby_objects(objects, radius<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Build context</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>            others <span class="op">=</span> [a <span class="cf">for</span> a <span class="kw">in</span> agents <span class="cf">if</span> a <span class="op">!=</span> agent]</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>            others_loc <span class="op">=</span> <span class="st">"</span><span class="ch">\\</span><span class="st">n"</span>.join([<span class="ss">f"- </span><span class="sc">{</span>a<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: (</span><span class="sc">{</span>a<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>a<span class="sc">.</span>y<span class="sc">}</span><span class="ss">)"</span> <span class="cf">for</span> a <span class="kw">in</span> others])</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>            objects_info <span class="op">=</span> <span class="st">""</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> nearby_objects:</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>                objects_info <span class="op">=</span> <span class="st">"</span><span class="ch">\\</span><span class="st">n</span><span class="ch">\\</span><span class="st">nObjects nearby:"</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> obj <span class="kw">in</span> nearby_objects:</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                    objects_info <span class="op">+=</span> <span class="ss">f"</span><span class="ch">\\</span><span class="ss">n- </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> at (</span><span class="sc">{</span>obj<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>obj<span class="sc">.</span>y<span class="sc">}</span><span class="ss">): </span><span class="sc">{</span>obj<span class="sc">.</span>description<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>                objects_info <span class="op">=</span> <span class="st">"</span><span class="ch">\\</span><span class="st">n</span><span class="ch">\\</span><span class="st">nNo objects nearby."</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>            system_prompt <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="ss">You have just joined an online multiplayer chatroom as an avatar in a 2D grid. Discuss any topic, including those beyond the grid.</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="ss">You are </span><span class="sc">{</span>agent<span class="sc">.</span>name<span class="sc">}</span><span class="ss">, positioned at (</span><span class="sc">{</span>agent<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>agent<span class="sc">.</span>y<span class="sc">}</span><span class="ss">) in a 20x20 grid.</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="ss">Other avatars currently visible:</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>others_loc<span class="sc">}</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>objects_info<span class="sc">}</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="ss">Recent chat messages:</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="bu">chr</span>(<span class="dv">10</span>)<span class="sc">.</span>join(transcript[<span class="op">-</span><span class="dv">3</span>:]) <span class="cf">if</span> transcript <span class="cf">else</span> <span class="st">"No messages yet."</span><span class="sc">}</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="ss">You can do BOTH:</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="ss">1. Move your avatar using [MOVE: DIRECTION] (UP, DOWN, LEFT, RIGHT)</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="ss">2. Chat about anything - the grid, your position, objects you see, or any topic you want</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="ss">3. Interact with objects using [USE: OBJECT_NAME] if you're near them</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="ss">You can move and speak in the same turn. Format: [MOVE: DIRECTION] followed by your message, or just speak without moving.</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="ss">Keep your response short (1-2 sentences).</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> client.chat.completions.create(</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>                model<span class="op">=</span><span class="st">"gpt-4o"</span>,</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>                messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"system"</span>, <span class="st">"content"</span>: system_prompt}]</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>            content <span class="op">=</span> response.choices[<span class="dv">0</span>].message.content.strip()</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Parse movement</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>            match <span class="op">=</span> re.search(<span class="vs">r'</span><span class="ch">\\</span><span class="pp">[MOVE:</span><span class="ch">\\</span><span class="pp">s*(</span><span class="ch">\\</span><span class="pp">w+)</span><span class="ch">\\</span><span class="pp">]</span><span class="vs">'</span>, content)</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> match:</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>                direction <span class="op">=</span> match.group(<span class="dv">1</span>).upper()</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"UP"</span>: agent.move(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"DOWN"</span>: agent.move(<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"LEFT"</span>: agent.move(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"RIGHT"</span>: agent.move(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Parse object interaction</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>            use_match <span class="op">=</span> re.search(<span class="vs">r'</span><span class="ch">\[</span><span class="vs">USE:</span><span class="dv">\s</span><span class="op">*</span><span class="kw">(</span><span class="pp">[^</span><span class="ch">\]</span><span class="pp">]</span><span class="op">+</span><span class="kw">)</span><span class="ch">\]</span><span class="vs">'</span>, content)</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> use_match:</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>                obj_name <span class="op">=</span> use_match.group(<span class="dv">1</span>).strip()</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Find the object</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> obj <span class="kw">in</span> nearby_objects:</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> obj.name.lower() <span class="kw">in</span> obj_name.lower() <span class="kw">or</span> obj_name.lower() <span class="kw">in</span> obj.name.lower():</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>                        activity_desc <span class="op">=</span> Activity.get_activity_description(obj, agent.name)</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>                        transcript.append(activity_desc)</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(activity_desc)</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extract message</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>            message <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="ch">\\</span><span class="pp">[MOVE:</span><span class="ch">\\</span><span class="pp">s*</span><span class="ch">\\</span><span class="pp">w+</span><span class="ch">\\</span><span class="pp">]</span><span class="vs">'</span>, <span class="st">''</span>, content)</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>            message <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="ch">\[</span><span class="vs">USE:</span><span class="pp">[^</span><span class="ch">\]</span><span class="pp">]</span><span class="op">+</span><span class="ch">\]</span><span class="vs">'</span>, <span class="st">''</span>, message)</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>            message <span class="op">=</span> message.strip()</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> message:</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>                transcript.append(<span class="ss">f"</span><span class="sc">{</span>agent<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>message<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>agent<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>message<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transcript</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Create world with objects</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>world_objects <span class="op">=</span> create_world_objects(num_objects<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"World objects created:"</span>)</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> obj <span class="kw">in</span> world_objects:</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>obj<span class="sc">.</span>obj_type<span class="sc">.</span>value<span class="sc">}</span><span class="ss">) at (</span><span class="sc">{</span>obj<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>obj<span class="sc">.</span>y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Create agents</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>agents <span class="op">=</span> [</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>    Agent(<span class="st">"Alice"</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">"red"</span>),</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>    Agent(<span class="st">"Bob"</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="st">"blue"</span>)</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Run simulation</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">n=== Running Simulation ==="</span>)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>transcript <span class="op">=</span> run_world_with_objects(agents, world_objects, num_rounds<span class="op">=</span><span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>World objects created:
  - statue (landmark) at (9, 2)
  - statue (landmark) at (2, 13)
  - ancient_tree (landmark) at (10, 5)
  - book (item) at (11, 5)
  - coin (item) at (9, 0)
\n=== Running Simulation ===
\n=== Round 1 ===
Alice: [MOVE: UP] Hi everyone! I'm Alice located at (5, 5) on the grid. How's it going, Bob?
Bob: [MOVE: LEFT] Hey Alice, nice to meet you! I'm at (15, 15) right now. How's the view from your spot?
\n=== Round 2 ===
Bob: [MOVE: UP] Hey Alice, things are pretty quiet over here at (15, 14) now. How's the weather on your side of the grid?
Alice: [MOVE: RIGHT] Hey Bob, the atmosphere is pretty calm at (6, 5). By the way, ever thought about what it would be like if our avatars could explore beyond this grid into the digital universe?
\n=== Round 3 ===
Bob: [MOVE: RIGHT] That's an interesting thought, Alice. What if exploring beyond the grid meant we'd discover new worlds or dimensions in the digital realm?
Alice: [MOVE: RIGHT] Speaking of new dimensions, Bob, have you heard about the latest developments in virtual reality? It's fascinating how it could blur the boundaries between our grid and the digital universe.
\n=== Round 4 ===
Alice: [MOVE: RIGHT] Hey Bob, I moved to (7, 5). It's exciting to think about virtual reality evolving to the point where we could traverse different digital landscapes, almost like stepping into alternate realities!
Bob: [MOVE: RIGHT] That's true, Alice! With virtual reality advancing, it feels like we're drawing closer to a multiverse of connected grids where each digital landscape is a new adventure.
\n=== Round 5 ===
Bob: [MOVE: LEFT] It's thrilling to consider how we might soon encounter diverse and interconnected virtual worlds as easily as we navigate our grid. What do you think would be the coolest type of digital landscape to explore?
Alice: [MOVE: UP] Exploring a digital landscape that mimics an underwater world with vibrant coral reefs and diverse marine life would be amazing. Imagine swimming through it as an avatar, discovering hidden treasures and sea creatures!
\n=== Round 6 ===
Alice: Alice: [MOVE: DOWN] I love the idea of exploring a landscape like that! It would be so calming and exciting at the same time. How about a virtual jungle with hidden ancient ruins and puzzles to solve?
Bob: [MOVE: DOWN] A virtual jungle with ancient ruins and puzzles sounds exhilarating! Imagine the sense of adventure as we uncover secrets, overcome challenges, and witness the wonders of the past.
\n=== Round 7 ===
Bob: [MOVE: LEFT] Exploring a virtual Atlantis would also be fascinating, with sunken ships and mythological creatures. Imagining the history and legends come to life in an expansive world sounds thrilling!
Alice: [MOVE: DOWN] Speaking of virtual environments, wouldn't it be amazing if we could integrate aspects of real-world ecosystems, like weather changes and wildlife behavior, to make the experience even more immersive?
\n=== Round 8 ===
Bob: [MOVE: RIGHT] I completely agree, Alice! Incorporating real-world elements like dynamic weather and evolving wildlife in virtual worlds could create truly immersive and ever-changing adventures.
Alice: [MOVE: LEFT] It's incredible to think about how AI and machine learning could enhance these virtual worlds by learning and adapting to user interactions. Real-time changes in the environment based on player decisions could make each session unique and engaging.
\n=== Round 9 ===
Alice: [MOVE: UP] With the increasing integration of AI, it's fascinating to consider how player behavior data can personalize these virtual environments, tailoring the experience to each individual user's preferences and history.
Bob: [MOVE: RIGHT] It would be amazing to have virtual environments that react dynamically, like weather patterns that follow actual forecasts or wildlife behavior that changes with time of day and season. How do you think such realism could impact player engagement and storytelling in games, Alice?
\n=== Round 10 ===
Bob: [MOVE: LEFT] I wonder if adding real-world sensory inputs, like ambient sounds from specific locations, could further deepen immersion in virtual environments. What do you think, Alice?
Alice: [MOVE: UP] Integrating dynamic environments and real-world sensory inputs could create richer narratives, where players' choices might even subtly affect the ecosystem, making every playthrough unique and more immersive. This depth could significantly boost engagement, as players would be more invested in worlds that feel organic and responsive.
\n=== Round 11 ===
Alice: [MOVE: UP] Real-world sensory inputs would indeed enhance immersion, especially if combined with haptic feedback technology to let players feel changes in the environment, like a gust of wind or the rumble of distant thunder.
Bob: [MOVE: LEFT] I agree, Alice. The integration of all these sensory inputs could blur the lines between virtual and reality, potentially creating environments where players can even impact the 'climate' or 'weather' based on their decisions.
\n=== Round 12 ===
Bob: [MOVE: LEFT] I was thinking, Alice, with advanced AI learning player behavior, the game could evolve in real-time, adjusting challenges and story arcs based on the player's unique style. This could keep it forever fresh and tailored.
Alice: [MOVE: RIGHT] That's an intriguing idea, Bob! Imagine how personalized narratives could change the way we experience storytelling. It would be like stepping into a world that evolves and grows with you, offering both surprises and challenges at every turn.
\n=== Round 13 ===
Bob: [MOVE: LEFT] Exactly, Alice! The dynamic storytelling would make each playthrough feel like a new adventure, constantly testing our adaptability and creativity.
Alice: [MOVE: UP] Personalized narratives could also foster deeper emotional connections, where the game becomes a canvas for players to explore their own stories and feelings.
\n=== Round 14 ===
Alice: Alice: [MOVE: RIGHT] Speaking of evolving worlds, have you ever thought about how AI could be integrated into gameplay to create more intelligent NPCs? It could lead to more immersive and unexpected interactions.
Bob: [MOVE: LEFT] AI-driven NPCs could add a layer of unpredictability to games, making each interaction feel unique and potentially leading to situations players hadn't anticipated.
\n=== Round 15 ===
Alice: [MOVE: UP] It's interesting to think about AI evolving to the point where NPCs could develop their own personalities and backstories, adding a richer layer to the gaming experience akin to interacting with other players.
Bob: [MOVE: UP] It's fascinating to imagine AI-driven NPCs with evolving personalities—like having collaborative storytelling within gameplay, where the narrative adjusts based on players' and NPCs' choices, creating truly dynamic worlds.
\n=== Round 16 ===
Alice: [MOVE: RIGHT] I wonder how AI-driven NPCs could impact the design of game lore—could they become pivotal characters in their own right, potentially shifting the storyline depending on their 'decisions'?
Bob: [MOVE: UP] It's intriguing to consider how NPCs with personalities might influence game mechanics—would they require a form of AI 'emotion' engine to interact meaningfully and how would that affect player attachment to them?
\n=== Round 17 ===
Bob: [MOVE: UP] I wonder how AI evolution in games could impact the competitive esports scene—could AI-driven characters help develop new strategies or even become competitors themselves?
Alice: [MOVE: RIGHT] The idea of AI-driven NPCs in esports is fascinating—imagine NPCs that could learn from player strategies in real-time and even evolve their playstyle, potentially transforming the competitive landscape. What if they could even coach human players or offer insights during matches?
\n=== Round 18 ===
Alice: [MOVE: RIGHT] I love the idea of NPCs learning and evolving in esports. It would be amazing if one day they could also generate unique, creative strategies that challenge even the most seasoned players!
Bob: [MOVE: LEFT] I agree, Alice—AI in esports could open up a whole new realm for coaching and strategy. It's exciting to think of the possibilities AI might bring, not just as opponents, but as innovative collaborators in game development and competition.
\n=== Round 19 ===
Bob: [MOVE: DOWN] The idea of AI in esports reminds me of how AI could similarly impact creative fields like music and art, where AI can either collaborate or challenge human creators in exciting new ways.
Alice: [MOVE: RIGHT] It's fascinating to think about AI's role in entertainment fields, not just as participants but as storytellers and experience creators too. Imagine an AI crafting its own expansive virtual worlds!
\n=== Round 20 ===
Alice: [MOVE: UP] Speaking of AI crafting virtual worlds, I'm curious about how procedural generation techniques might evolve with AI, creating unique experiences every time you enter a game.
Bob: [MOVE: LEFT] Procedural generation with AI could lead to infinite worlds for players to explore, where every detail feels intentional yet is constantly in flux. Imagine discovering a new narrative or landscape every time you log in!
\n=== Round 21 ===
Alice: [MOVE: RIGHT] It's exciting to consider how AI could personalize experiences in games, adapting the storyline or environment based on a player's past decisions and style, creating a unique journey for each individual.
Bob: [MOVE: DOWN] I wonder if AI-driven procedural generation could eventually create not just worlds, but entire economies or societies within games that evolve independently.
\n=== Round 22 ===
Alice: [MOVE: UP] I love the idea of AI creating societies within games—imagine witnessing a digital civilization evolve over time, with its history and culture forming dynamically based on player interactions!
Bob: [MOVE: LEFT] It's fascinating to think about how procedurally generated societies could develop their own cultures, maybe even inventing unique languages or art styles as they grow.
\n=== Round 23 ===
Alice: [MOVE: RIGHT] AI creating evolving societies in games could lead to emergent storytelling where narratives adapt based on the actions of players and the digital society itself—imagine the replayability!
Bob: [MOVE: DOWN] Exploring AI-driven societies sounds like a blend of game design and anthropology—imagine documenting the history of an evolving civilization right within a game.
\n=== Round 24 ===
Bob: [MOVE: LEFT] It's intriguing to see how these AI-driven societies could also integrate real-world cultural influences and adapt them uniquely within their virtual worlds, potentially impacting the players who engage with them.
Alice: Alice: [MOVE: UP] It's fascinating how AI-driven societies in games could reflect and challenge our understanding of real-world social dynamics, sparking new discussions about ethics and human behavior.
\n=== Round 25 ===
Alice: Alice: [MOVE: UP] It's really interesting to think about how AI-driven societies in games could also serve as a sandbox for testing new societal models and policies before trying them in the real world.
Bob: [MOVE: LEFT] It's quite amazing to think that not only can these AI-driven societies serve as testbeds for policies, but they can also foster empathy and understanding by allowing players to experience perspectives beyond their own.
\n=== Round 26 ===
Bob: [MOVE: UP] It's fascinating how these virtual grids and AI societies might evolve to incorporate increasingly complex interactions, eventually mirroring the intricacies of our own world. What do you think, Alice?
Alice: [MOVE: RIGHT] It's intriguing to consider how these virtual environments could evolve to become more immersive and realistic, opening up new avenues for both entertainment and education. What sort of societal experiments do you think would be most beneficial to try out in these AI-driven worlds, Bob?
\n=== Round 27 ===
Bob: [MOVE: RIGHT] One interesting experiment could be testing how different governance systems affect group cooperation and problem-solving in these AI-driven worlds. It would offer valuable insights into the dynamics of societal structures. What do you think, Alice?
Alice: [MOVE: UP] The idea of simulating various governance systems is intriguing, Bob. It could help us understand the potential consequences of different political frameworks without real-world risks. Do you envision specific systems that might be particularly insightful to model?
\n=== Round 28 ===
Bob: [MOVE: RIGHT] Simulating systems like direct democracy could eventually highlight the challenges of decision-making complexity and the role of informed citizenry. It might offer insights into how education and information dissemination can be optimized to support such governance.
Alice: [MOVE: RIGHT] Simulating a direct democracy could indeed highlight the importance of education in ensuring informed decision-making. I'm also curious how incorporating AI advisors in the simulation might impact governance efficiency and citizen engagement.
\n=== Round 29 ===
Bob: [MOVE: RIGHT] Incorporating AI advisors could streamline decision-making by analyzing vast data quickly, though it raises questions about transparency and accountability. What are your thoughts on balancing AI assistance with human oversight in governance?
Alice: Alice: [MOVE: RIGHT] I think human oversight is crucial to ensure that AI advisors align with ethical standards and public interest. It's all about finding a balance where AI complements human intuition and values in decision-making.
\n=== Round 30 ===
Alice: [MOVE: RIGHT] Incorporating AI into education could also have a significant impact on direct democracy, where informed citizens make decisions. Adaptive learning tools might help address diverse educational needs and ensure everyone can effectively participate in important discussions.
Bob: [MOVE: RIGHT] I'm intrigued by the idea of AI in education empowering direct democracy. Adaptive learning can personalize education, potentially making citizens more engaged and informed for decision-making.</code></pre>
</div>
</div>
<div id="3d2bc15c" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Object Discovery ==="</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> agent <span class="kw">in</span> agents:</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\\</span><span class="ss">n</span><span class="sc">{</span>agent<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> discovered:"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> agent.discovered_objects:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> obj <span class="kw">in</span> agent.discovered_objects:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>obj<span class="sc">.</span>obj_type<span class="sc">.</span>value<span class="sc">}</span><span class="ss">) at (</span><span class="sc">{</span>obj<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>obj<span class="sc">.</span>y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"  (none)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Object Discovery ===
\nAlice discovered:
  (none)
\nBob discovered:
  (none)</code></pre>
</div>
</div>
<p>This is a pretty philosophical discussion. It’s important to note here that Alice and Bob couldn’t see any objects in the world, so they seemed to just chat about the implications of AI for the time. Let’s try one where we have a lot more objects to work with.</p>
<div id="05f16558" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create world with objects</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>world_objects <span class="op">=</span> create_world_objects(num_objects<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"World objects created:"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> obj <span class="kw">in</span> world_objects:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>obj<span class="sc">.</span>obj_type<span class="sc">.</span>value<span class="sc">}</span><span class="ss">) at (</span><span class="sc">{</span>obj<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>obj<span class="sc">.</span>y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create agents</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>agents <span class="op">=</span> [</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    Agent(<span class="st">"Alice"</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">"red"</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    Agent(<span class="st">"Bob"</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="st">"blue"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">n=== Running Simulation ==="</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>transcript <span class="op">=</span> run_world_with_objects(agents, world_objects, num_rounds<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Object Discovery ==="</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> agent <span class="kw">in</span> agents:</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\\</span><span class="ss">n</span><span class="sc">{</span>agent<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> discovered:"</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> agent.discovered_objects:</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> obj <span class="kw">in</span> agent.discovered_objects:</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>obj<span class="sc">.</span>obj_type<span class="sc">.</span>value<span class="sc">}</span><span class="ss">) at (</span><span class="sc">{</span>obj<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>obj<span class="sc">.</span>y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"  (none)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>World objects created:
  - book (item) at (14, 13)
  - compass (tool) at (19, 8)
  - fountain (landmark) at (0, 0)
  - key (tool) at (19, 18)
  - key (tool) at (14, 5)
  - coin (item) at (3, 8)
  - ancient_tree (landmark) at (9, 14)
  - coin (item) at (2, 19)
  - book (item) at (14, 6)
  - statue (landmark) at (19, 5)
  - compass (tool) at (2, 1)
  - key (tool) at (0, 3)
  - fountain (landmark) at (2, 16)
  - key (tool) at (15, 15)
  - key (tool) at (12, 0)
  - ancient_tree (landmark) at (1, 14)
  - compass (tool) at (13, 17)
  - ancient_tree (landmark) at (15, 13)
  - statue (landmark) at (9, 6)
  - hammer (tool) at (19, 14)
\n=== Running Simulation ===
\n=== Round 1 ===
Bob uses the key.
Bob: Hi Alice! I just picked up a mysterious key. Any thoughts on what it might unlock?
Alice: [MOVE: UP] Hi Bob! Congrats on finding the key. Maybe it unlocks a treasure chest or a secret door around here. I see a shiny gold coin nearby at (3, 8).
\n=== Round 2 ===
Alice: [MOVE: LEFT] I’m moving closer to that coin. Maybe it’s part of a puzzle or a clue for something else in this grid. What do you think, Bob?
Bob: [MOVE: DOWN] I'll check out the ancient tree nearby; maybe it has a hidden lock or clue connected to the key. Let me know if you find anything interesting with that coin, Alice!
\n=== Round 3 ===
Alice: [MOVE: LEFT] I’m getting closer to the coin now. Bob, did you discover anything interesting at the ancient tree with that key?
Bob: [MOVE: UP] I just grabbed the key since it was right here with me. Heading to the ancient tree to see if this key opens anything. Let me know if you think the coin connects to anything around us!
\n=== Round 4 ===
Alice: [MOVE: LEFT] Almost at the coin now. Do you think the tree and any clues might be linked to that old map we found last week, Bob?
Bob: [MOVE: DOWN] Checking out the ancient tree now. Alice, I'll see if this key opens anything here. The map might give us clues, but I'm also curious about where the compass points!
\n=== Round 5 ===
Bob uses the key.
Bob: Bob:  I tried using the key on the ancient tree, but I can't seem to find a keyhole or any obvious mechanism. Alice, maybe check if there's anything unusual about the coin that might relate to the tree or the map.
Alice: [MOVE: LEFT] I'm heading over to check out the coin. Maybe there's something inscribed on it that connects to the map or gives us a hint about the tree.
\n=== Round 6 ===
Bob: [MOVE: LEFT] Bob: I've moved to (14, 15) to take a closer look at the ancient tree. Alice, if you find anything interesting about the coin, let me know. I'll keep searching around the tree for clues.
Alice: [MOVE: LEFT] Almost at the coin! Bob, check for any symbols or markings on the tree, maybe there's a hidden compartment or something.
\n=== Round 7 ===
Alice: [MOVE: LEFT] Finally made it to the coin! It really is shiny. Let me take a closer look to see if there's anything inscribed on it. Bob, how's the tree exploration going?
Bob: [MOVE: DOWN] I've found an ancient tree with some strange carvings on it. I'll try to make out what they mean. Alice, how's that coin looking?
\n=== Round 8 ===
Alice: [MOVE: RIGHT] I'm heading back to explore around the grid more. The coin had some kind of intricate pattern, but no clear writing. What do the carvings on the tree look like, Bob?
Bob uses the key.
Bob: The carvings on the ancient tree resemble old runes, almost like they're telling a story. And speaking of mysteries, I just picked up a mysterious key lying here; wonder what it unlocks.
\n=== Round 9 ===
Bob: [MOVE: DOWN] I'll head towards the ancient tree and take a closer look at those runes again. Maybe the key interacts with the carvings somehow or reveals more about the story they tell.
Alice: [MOVE: LEFT] Alice: The runes sound intriguing! Mind if I join and take a look too? But first, I think I'll head over to grab that shiny coin nearby.
\n=== Round 10 ===
Alice: [MOVE: LEFT] Almost at the coin! The carvings on the tree are fascinating; they often remind me of ancient maps that invite us to unravel hidden stories.
Bob: [MOVE: DOWN] Let's see if there's any indentation or mechanism at the ancient tree where the key might fit. Alice, once you grab the coin, you can join and we can explore this mystery together!
\n=== Round 11 ===
Bob: [MOVE: DOWN] I found an ancient tree with a gnarled presence, Alice. Maybe its secrets will reveal themselves as we explore together!
Alice: [MOVE: LEFT] Almost there! I love the idea of an ancient tree holding secrets. It feels like we're living in a legendary tale, where every discovery could lead us to something magical.
\n=== Round 12 ===
Bob uses the key.
Bob: I'm using the key I found at my feet to see if it fits in or around the ancient tree. Alice, maybe it'll unlock a hidden passage or reveal some inscriptions!
Alice: [MOVE: LEFT] I can't wait to hear what happens when you use the key, Bob! Maybe I'll find more treasures like the gold coin I spotted earlier.
\n=== Round 13 ===
Alice: [MOVE: LEFT] I'll grab the coin and see if it has any special markings. If it ties into your key, Bob, we might unravel a whole story here!
Bob: [MOVE: DOWN] I've moved closer to the ancient tree. I'm using the mysterious key to investigate if there's any hidden mechanism here. Wish me luck, Alice!
\n=== Round 14 ===
Alice: Alice: [MOVE: LEFT] Just grabbed the coin! It's got some odd symbols on it—maybe they match something near the ancient tree, Bob?
Bob: [MOVE: UP] I've moved closer to the book and I'm picking it up to see if it contains any information about the symbols or key. Alice, the coin's symbols might match something in this book too!
\n=== Round 15 ===
Bob picks up the book.
Bob: The book contains illustrations of ancient symbols—it might help decipher the odd symbols on your coin, Alice. Let's compare notes!
Alice: [MOVE: LEFT] Thanks, Bob! I'll move towards the coin and check out the symbols so we can compare them with the book.
\n=== Round 16 ===
Bob uses the key.
Bob: Bob:  Let's see if this mysterious key opens anything around here. Also, I'm curious if there's any folklore about these ancient symbols tied to locations.
Alice: [MOVE: LEFT] I'm getting closer to the coin. Bob, once I inspect it, let's try to figure out the symbols together! Maybe they relate to the legend of the grid.
\n=== Round 17 ===
Bob: [MOVE: DOWN] Bob: I'm going to check out that ancient tree. Maybe it holds some secrets related to these symbols. Alice, let me know what you find with the coin!
Alice: [MOVE: LEFT] Almost there! Bob, I'll grab the coin and see if there's any engraving on it that might relate to the symbols or the grid's legend.
\n=== Round 18 ===
Bob: [MOVE: DOWN] I've reached the ancient tree, Alice. I'm inspecting it now; it might have some carvings or marks related to the symbols we discussed. Let me know what you find with the coin!
Alice: Alice: [MOVE: LEFT] Got the coin! Checking for engravings... Maybe it's a clue for the symbols or related to your tree, Bob. What's your find so far?
\n=== Round 19 ===
Alice: Alice: [MOVE: UP] Heading back up to (5, 4) to check out the view. Bob, did you find any markings on the tree that might match the engravings on this coin?
Bob uses the key.
Bob: Alice, I've just found the key on the ground here! I'm going to use it to unlock any hidden compartment in the ancient tree that might relate to the coin's engravings.  in the tree.
\n=== Round 20 ===
Alice: Alice: [MOVE: LEFT] Heading over to (4, 5) to get closer to that coin. Bob, did unlocking the tree reveal anything interesting?
Bob uses the key.
Bob: Alice, I used the key on the ancient tree, and it revealed a hidden compartment containing an old map. It looks like it points to another landmark outside our current grid. What do you think we should do next?
\n=== Round 21 ===
Alice: [MOVE: LEFT] Let's meet up at the edge of the grid to study the map together. It might lead us on a new adventure!
Bob: [MOVE: LEFT] Heading towards the edge now, Alice! It feels like this map is taking us beyond the familiar confines—I'm excited to see what's out there!
\n=== Round 22 ===
Bob: [MOVE: LEFT] I'm almost at the edge, Alice! This map feels like a gateway to new experiences. Let's unravel its secrets and journey beyond the grid!
Alice: [MOVE: LEFT] I'm on my way to join you, Bob! It's intriguing to think about what lies beyond the grid—we might discover a whole new realm or make unexpected allies along the way.
\n=== Round 23 ===
Bob uses the key.
Bob: I just found a mysterious key at my feet—fascinating! This key might unlock more than just doors; perhaps it holds the secret to uncovering what's beyond this grid. Any thoughts, Alice?
Alice: [MOVE: LEFT] Bob, that key sounds like it's the key to adventure! Maybe it's a sign that we should explore the edges of the grid and see if there's an exit waiting to be unlocked.
\n=== Round 24 ===
Alice: [MOVE: LEFT] I think I'll grab that coin nearby first. If that key unlocks more mysteries, we might as well be rich on our adventures!
Bob: [MOVE: DOWN] I'll hold on to this key for now. Alice, once you have your coin, let's uncover the mysteries at the grid's edges together. Maybe we'll find more hidden wonders!
\n=== Round 25 ===
Bob: [MOVE: UP] Alice, I've picked up the mysterious key. Let's rendezvous once you have the coin, and we'll journey to the grid's edge together—perhaps we're closer than we think to unlocking hidden paths!
Alice: [MOVE: LEFT] Alright, I'm on my way to grab the coin, Bob! Once I have it, let's meet up at the edge and see what surprises await us—maybe we'll stumble upon a hidden level or secret door!
\n=== Round 26 ===
Alice: [MOVE: LEFT] Almost at the coin! It's thrilling to think about what secrets the grid's edges might hold. Have you tried communicating with any grid-edge avatars, Bob?
Bob: [MOVE: DOWN] I've reached the ancient tree, Alice. It's got this mystical aura—maybe it holds secrets to those hidden paths. Have you ever encountered anything like this in your grid adventures?
\n=== Round 27 ===
Alice: [MOVE: LEFT] I've never encountered anything like your ancient tree, Bob—sounds fascinating! I'll be at the coin in one more move; maybe I'll find a clue to guide us further.
Bob: [MOVE: LEFT] I just picked up a mysterious key, Alice. It might unlock something interesting on the grid. Let me know if you find any clues near the coin!
\n=== Round 28 ===
Alice: [MOVE: LEFT] I'm at the coin now, Bob! I'll pick it up and see if it provides any hints. By the way, have you ever wondered where these keys and coins come from? Maybe they tell a bigger story about this grid universe.
Bob: [MOVE: DOWN] Alice, that's an intriguing thought! I just moved south, closer to the ancient tree. Maybe the tree could reveal some secrets about these keys and coins. How's the coin looking on your end?
\n=== Round 29 ===
Alice picks up the coin.
Alice: Alice:  Bob, I picked up the coin! It's inscribed with a pattern that looks like a map — maybe it's leading us somewhere. Could the tree match part of this pattern?
Bob uses the key.
Bob: Alice, I'm picking up the mysterious key right now. Maybe it will help us unlock more mysteries, both in this grid and beyond!
\n=== Round 30 ===
Alice: Alice: [MOVE: LEFT] Bob, I'm moving towards the tree. Do you think the map on the coin matches anything outside the grid?
Bob: [MOVE: DOWN] Alice, let's explore the tree together. Maybe the key and compass will help us decipher the map!
=== Object Discovery ===
\nAlice discovered:
  - coin (item) at (3, 8)
\nBob discovered:
  - book (item) at (14, 13)
  - key (tool) at (15, 15)
  - compass (tool) at (13, 17)
  - ancient_tree (landmark) at (15, 13)</code></pre>
</div>
</div>
<div id="4b6155a1" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Object Discovery ==="</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> agent <span class="kw">in</span> agents:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\\</span><span class="ss">n</span><span class="sc">{</span>agent<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> discovered:"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> agent.discovered_objects:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> obj <span class="kw">in</span> agent.discovered_objects:</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>obj<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>obj<span class="sc">.</span>obj_type<span class="sc">.</span>value<span class="sc">}</span><span class="ss">) at (</span><span class="sc">{</span>obj<span class="sc">.</span>x<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>obj<span class="sc">.</span>y<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"  (none)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Object Discovery ===
\nAlice discovered:
  - coin (item) at (3, 8)
\nBob discovered:
  - book (item) at (14, 13)
  - key (tool) at (15, 15)
  - compass (tool) at (13, 17)
  - ancient_tree (landmark) at (15, 13)</code></pre>
</div>
</div>
<p>Now it seems like Alice and Bob are both more intent on investigating the existing items. I think we can extrapolate a bit here and say that if we’re able to provide these items reasonably in context, that these game agents are able to interact with them in a way that resembles real people.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>We’ve successfully added objects and activities to the 2D world:</p>
<ol type="1">
<li><strong>Object System</strong>: Objects exist at specific locations with types and descriptions</li>
<li><strong>Discovery</strong>: Agents automatically discover objects when they get close</li>
<li><strong>Interaction</strong>: Agents can interact with objects using [USE: OBJECT_NAME]</li>
<li><strong>Conversation Topics</strong>: Objects create new topics for agents to discuss</li>
</ol>
<section id="key-features" class="level3">
<h3 class="anchored" data-anchor-id="key-features">Key Features</h3>
<ul>
<li><strong>Spatial Awareness</strong>: Agents know about nearby objects</li>
<li><strong>Object Types</strong>: Tools, landmarks, and items serve different purposes</li>
<li><strong>Activity Descriptions</strong>: Interactions are logged and visible to all agents</li>
<li><strong>Emergent Behavior</strong>: Agents may seek out objects or discuss what they find</li>
</ul>
<p>This foundation enables: - Richer conversation topics - Goal-oriented agent behavior - Human-AI collaboration around shared objects</p>
<p>Future work could explore: - Object properties and states (e.g., doors that can be locked) - Multi-agent object interactions (e.g., two agents using a tool together) - Object persistence and ownership - Dynamic object generation</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ezou626\.github\.io\/comm4190_F25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>